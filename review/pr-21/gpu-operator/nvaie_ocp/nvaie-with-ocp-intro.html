<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NVIDIA AI Enterprise with OpenShift &mdash; NVIDIA Cloud Native Technologies  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/nvidia.ico"/>
    <link rel="canonical" href="https://docs.nvidia.com/datacenter/cloud-native/gpu-operator/nvaie_ocp/nvaie-with-ocp-intro.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/js/google-analytics/google-analytics-tracker.js"></script>
        <script src="../../_static/js/google-analytics/google-analytics-write.js"></script>
        <script src="//assets.adobedtm.com/b92787824f2e0e9b68dc2e993f9bd995339fe417/satelliteLib-7ba51e58dc61bcb0e9311aadd02a0108ab24cc6c.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" > 
            <a href="../../contents.html">
            <img src="../../_static/NVLogo_H_B&W.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #76b900;
    }

    .wy-side-nav-search a:link, .wy-nav-top a:link {
      color: #fff;
    }
    .wy-side-nav-search a:visited, .wy-nav-top a:visited {
      color: #fff;
    }
    .wy-side-nav-search a:hover, .wy-nav-top a:hover {
      color: #fff;
    }

    .wy-menu-vertical a:link, .wy-menu-vertical a:visited {
      color: #d9d9d9
    }

    .wy-menu-vertical a:active {
      background-color: #76b900
    }

    .wy-side-nav-search>div.version {
      color: rgba(0, 0, 0, 0.3)
    }

    .wy-nav-content {
      max-width: 1000px;
    }
  </style>
  
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">NVIDIA Container Toolkit:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../container-toolkit/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../container-toolkit/concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../container-toolkit/arch-overview.html">Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../container-toolkit/install-guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../container-toolkit/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../container-toolkit/user-guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../container-toolkit/release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../container-toolkit/archive.html">Archive</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NVIDIA GPU Operator:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platform-support.html">Platform Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-driver-upgrades.html">GPU Driver Upgrades</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install-gpu-operator-vgpu.html">NVIDIA vGPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install-gpu-operator-nvaie.html">NVIDIA AI Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openshift/contents.html">GPU Operator on OpenShift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-operator-mig.html">GPU Operator with MIG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-sharing.html">Time-Slicing GPUs in Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-operator-rdma.html">GPUDirect RDMA and GPUDirect Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-operator-kubevirt.html">GPU Operator with KubeVirt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html">Advanced Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../archive.html">Archive</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Kubernetes with GPUs:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../kubernetes/install-k8s.html">Install Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kubernetes/mig-k8s.html">MIG Support in Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kubernetes/anthos-guide.html">NVIDIA GPUs with Google Cloud’s Anthos</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GPU Telemetry:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gpu-telemetry/dcgm-exporter.html">DCGM-Exporter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gpu-telemetry/dcgm-exporter.html#integrating-gpu-telemetry-into-kubernetes">Integrating GPU Telemetry into Kubernetes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Multi-Instance GPU:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../mig/mig.html">Multi-Instance GPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mig/mig-k8s.html">MIG Support in Kubernetes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Driver Containers:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../driver-containers/overview.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Playground:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../playground/dind.html">Docker-in-Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../playground/x-arch.html">Running Cross-Architecture Containers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../contents.html">NVIDIA Cloud Native Technologies</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../contents.html" class="icon icon-home"></a> &raquo;</li>
      <li>NVIDIA AI Enterprise with OpenShift</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nvidia-ai-enterprise-with-openshift">
<span id="nvaie-ocp"></span><h1>NVIDIA AI Enterprise with OpenShift<a class="headerlink" href="#nvidia-ai-enterprise-with-openshift" title="Permalink to this heading"></a></h1>
<p>NVIDIA AI Enterprise is an end-to-end, cloud-native suite of AI and data analytics software, optimized, certified, and supported by NVIDIA with  NVIDIA-Certified  Systems. Additional information can be found at the <a class="reference external" href="https://www.nvidia.com/en-us/data-center/products/ai-enterprise-suite/#benefits">NVIDIA AI Enterprise web page</a>.</p>
<p>NVIDIA AI Enterprise 2.0 adds support for OpenShift Container Platform 4.9 and 4.10 and this section describes how customers can use NVIDIA AI Enterprise with OpenShift.</p>
<p>The following methods of installation are supported:</p>
<ul class="simple">
<li><p>OpenShift Container Platform bare metal/VMware vSphere with GPU Passthrough</p></li>
<li><p>OpenShift Container Platform on VMware vSphere with NVIDIA vGPUs</p></li>
</ul>
<section id="openshift-container-platform-bare-metal-or-vmware-vsphere-with-gpu-passthrough">
<h2>OpenShift Container Platform bare metal or VMware vSphere with GPU Passthrough<a class="headerlink" href="#openshift-container-platform-bare-metal-or-vmware-vsphere-with-gpu-passthrough" title="Permalink to this heading"></a></h2>
<p>For OpenShift Container Platform bare metal or VMware vSphere with GPU Passthrough no particular actions are needed. The default cluster policy works. For more information on creating a cluster policy see, <a class="reference internal" href="../openshift/install-gpu-ocp.html#create-cluster-policy"><span class="std std-ref">Create the cluster policy for the NVIDIA GPU Operator</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The NVIDIA datacenter driver is used in both installation scenarios.</p>
</div>
</section>
<section id="openshift-container-platform-on-vmware-vsphere-with-nvidia-vgpus">
<h2>OpenShift Container Platform on VMware vSphere with NVIDIA vGPUs<a class="headerlink" href="#openshift-container-platform-on-vmware-vsphere-with-nvidia-vgpus" title="Permalink to this heading"></a></h2>
<section id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h3>
<p>This section provides insights into deploying NVIDIA AI Enterprise for VMware vSphere with RedHat OpenShift’s Enterprise Kubernetes Platform.</p>
<p>A broad outline of the steps involved are:</p>
<ul class="simple">
<li><p>Install Red Hat OpenShift on VMware vSphere</p></li>
<li><p>Step 1: Create NLS License Config Map</p></li>
<li><p>Step 2: Import NGC Secret</p></li>
<li><p>Step 3: Install the Node Feature Discovery (NFD) Operator</p></li>
<li><p>Step 4: Install the NVIDIA GPU Operator</p></li>
<li><p>Step 5: Create the Cluster Policy Instance</p></li>
<li><p>Optional: Step 6: Install the NVIDIA Network Operator</p></li>
</ul>
<section id="prerequisites">
<h4>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>Access to an NVIDIA AI Enterprise License Token</p></li>
<li><p>Access to the NVIDIA AI Enterprise Enterprise Portal (this is the location where the UBI based vGPU driver image is hosted).</p></li>
</ul>
</section>
</section>
<section id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h3>
<p>When NVIDIA AI Enterprise is running on VMware vSphere based virtualized infrastructure, a key component is NVIDIA virtual GPU. The NVIDIA AI
Enterprise Host Software vSphere Installation Bundle (VIB) is installed on the VMware ESXi host server and it is responsible for communicating with the NVIDIA vGPU guest driver which is
installed on the guest VM. This software enables multiple VMs to share a single GPU, or if there are multiple GPUs in the server, they
can be aggregated so that a single VM can access multiple GPUs. Physical NVIDIA GPUs can support multiple virtual GPUs (vGPUs) and be assigned
directly to guest VMs under the control of NVIDIA’s AI Enterprise Host Software running in a hypervisor. Guest VMs use the NVIDIA vGPUs in the
same manner as a physical GPU that has been passed through by the hypervisor. In the VM itself, vGPU drivers are installed which support
the different license levels that are available.</p>
<section id="installing-ngc-catalog-cli">
<h4><strong>Installing NGC catalog CLI</strong><a class="headerlink" href="#installing-ngc-catalog-cli" title="Permalink to this heading"></a></h4>
<p>To access the NVIDIA AI Enterprise Host Software vSphere Installation Bundle (VIB), you must first download and install NGC Catalog CLI. After the NGC Catalog CLI is installed, you will need to launch a command window and then run commands to download software.</p>
<p>To install NGC Catalog CLI:</p>
<ol class="arabic">
<li><p>Enter the <a class="reference external" href="https://ngc.nvidia.com/">NVIDIA NGC</a>.</p></li>
<li><p>In the top right corner, click <strong>Welcome</strong> and then select <strong>Setup</strong> from the menu.</p></li>
<li><p>Click <strong>Downloads</strong> under Install NGC CLI from the Setup page.</p></li>
<li><p>From the CLI Install page, click the Windows, Linux, or MacOS tab, according to the platform from which you will be running NGC Catalog CLI.</p></li>
<li><p>Follow the instructions to install the CLI.</p></li>
<li><p>Open a Terminal or Command Prompt</p></li>
<li><p>Verify the installation by entering <code class="docutils literal notranslate"><span class="pre">ngc --version</span></code>. The output should be NGC Catalog CLI x.y.z where x.y.z indicates the version.</p></li>
<li><p>You must configure NGC CLI for your use so that you can run the commands. Enter the following command and then include your API key when prompted:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ngc<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span>

<span class="go">Enter API key [no-apikey]. Choices: [&lt;VALID_APIKEY&gt;, &#39;no-apikey&#39;]:</span>
<span class="gp gp-VirtualEnv">(COPY/PASTE API KEY)</span>

<span class="go">Enter CLI output format type [ascii]. Choices: [ascii, csv, json]:</span>
<span class="go">ascii</span>

<span class="go">Enter org [no-org]. Choices: [&#39;no-org&#39;]: nvlp-aienterprise</span>

<span class="go">Enter team [no-team]. Choices: [&#39;no-team&#39;]: no-team</span>

<span class="go">Enter ace [no-ace]. Choices: [&#39;no-ace&#39;]: no-ace</span>
</pre></div>
</div>
</li>
</ol>
<p>After the NGC Catalog CLI is installed, launch a command window and run the following commands to download the NVIDIA AI Enterprise Host Software (vib).</p>
<p><strong>NVIDIA AI Enterprise 2.0</strong></p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ngc registry resource download-version &quot;nvaie/vgpu_host_driver_1_1:470.105&quot;</span>

<span class="go">Choose the correct vib for your version of ESXi</span>

<span class="go">NVIDIA-AIE\_\ **ESXi_7.0.2**\ \_Driver_470.105-1OEM.702.0.0.17630552.vib</span>

<span class="go">NVIDIA-AIE\_\ **ESXi_6.7.0**\ \_Driver_470.105-1OEM.670.0.0.8169922.vib</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="hardware-requirements-and-prerequisites">
<h3>Hardware Requirements and prerequisites<a class="headerlink" href="#hardware-requirements-and-prerequisites" title="Permalink to this heading"></a></h3>
<p>The following hardware requirements and prerequisites need to be met:</p>
<ul>
<li><p>At least three NVIDIA AI Enterprise Compatible servers that are <a class="reference external" href="https://docs.nvidia.com/ngc/ngc-deploy-on-premises/nvidia-certified-systems/index.html">NVIDIA-Certified System</a>.</p></li>
<li><p>At least one of NVIDIA AI Enterprise Compatible servers must have a NVIDIA AI Enterprise supported <a class="reference external" href="https://docs.nvidia.com/ai-enterprise/overview/overview.html#supported-hardware-and-software">NVIDIA GPU</a>.</p></li>
<li><p>Recommended A100 for training and A30 for inference</p>
<ul class="simple">
<li><p>Single Root I/O Virtualization (SR-IOV) – Enabled</p></li>
<li><p>VT-d/IOMMU – Enabled</p></li>
</ul>
</li>
<li><p>The GPU accelerated server(s) must have NVIDIA AI Enterprise Host Software vSphere Installation Bundle (VIB) installed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The installation of VMware ESXi and the NVIDIA vGPU Host and Guest Driver Software is out of the scope of this document. Please refer to
the NVIDIA AI Enterprise Deployment Guide for detailed instructions. To set up AI-ready VMs on VMware, a vGPU profile needs to add to the VM.
This requires installing the vGPU Host Manager on ESXi, attaching a vGPU profile, installing a vGPU guest driver on the VM, and licensing the VM.
The following sections of the guide are helpful for reference:</p>
</div>
</li>
<li><p><a class="reference external" href="https://docs.nvidia.com/ai-enterprise/deployment-guide/dg-installing-esxi.html">Installing VMware ESXi</a></p></li>
<li><p><a class="reference external" href="https://docs.nvidia.com/ai-enterprise/deployment-guide/dg-vgpu.html">Installing and Configuring NVIDIA AI Enterprise Host Software</a></p></li>
<li><p><a class="reference external" href="https://docs.nvidia.com/ai-enterprise/deployment-guide/dg-nls.html">Deploying the NVIDIA License System</a></p></li>
<li><p><a class="reference external" href="https://docs.nvidia.com/ai-enterprise/deployment-guide/dg-first-vm.html">Creating a VM and installing the NVIDIA Driver in the VM</a></p></li>
<li><p><a class="reference external" href="https://docs.nvidia.com/ai-enterprise/deployment-guide/dg-first-vm.html#enabling-the-nvidia-vgpu">Selecting the Correct vGPU Profile</a></p></li>
</ul>
<p>Once the three NVIDIA AI Enterprise Compatible servers have met the above NVIDIA AI Enterprise hardware and software requirements, you must <a class="reference external" href="https://docs.openshift.com/container-platform/latest/installing/installing_vsphere/preparing-to-install-on-vsphere.html#choosing-a-method-to-install-ocp-on-vsphere">choose a method install OpenShift Container on
vSphere</a>.
For the authoring of this document, the <a class="reference external" href="https://docs.openshift.com/container-platform/latest/installing/installing_vsphere/preparing-to-install-on-vsphere.html#installer-provisioned-infrastructure-installation-of-openshift-container-platform-on-vsphere">Installer-provisioned
infrastructure (IPI)</a>
was chosen since it is pre-configured and automates the provisioning of resources which are required by OpenShift Container Platform.</p>
</section>
<section id="red-hat-openshift-on-vmware-vsphere">
<h3>Red Hat OpenShift on VMware vSphere<a class="headerlink" href="#red-hat-openshift-on-vmware-vsphere" title="Permalink to this heading"></a></h3>
<p>Follow the steps outlined in the <a class="reference external" href="https://docs.openshift.com/container-platform/latest/installing/installing_vsphere/preparing-to-install-on-vsphere.html">Installing vSphere section</a>
of the RedHat OpenShift documentation installing OpenShift on vSphere.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using virtualized GPUs you must change the boot method of each VM that is deployed as a worker and the VM template to be EFI.
This requires powering down running worker VMs. The template must be converted to a VM, then change the boot method to EFI, then convert back
to a Template. When using the <a class="reference external" href="https://docs.openshift.com/container-platform/4.9/installing/installing_vsphere/installing-vsphere.html#installation-vsphere-machines_installing-vsphere">UPI install method</a>, after <strong>Step 8</strong> of the “Installing RHCOS and starting the OpenShift
container Platform bootstrap process” change the boot method to EFI before <strong>continuing to Step 9.</strong> When using the IPI method, each VM’s boot method can be changed to EFI after VM deployment.</p>
</div>
</div></blockquote>
<p>It is also recommended that you leverage <a class="reference external" href="https://core.vmware.com/resource/running-red-hat-openshift-container-platform-vmware-cloud-foundation#executive-summary">Running Red Hat OpenShift Container Platform on VMware Cloud Foundation</a> documentation for deployment best practices, system configuration, and reference architecture.</p>
<p>NVIDIA AI Enterprise 2.0 requires OpenShift Container Platform Version 4.9+</p>
</section>
<section id="create-cls-license-config-map">
<h3>Create CLS License Config Map<a class="headerlink" href="#create-cls-license-config-map" title="Permalink to this heading"></a></h3>
<p>The NVIDIA License System serves licenses to NVIDIA software products. To activate licensed functionalities, a licensed client leases a
software license served over the network from an NVIDIA Cloud License System (CLS). The <a class="reference external" href="https://docs.nvidia.com/license-system/latest/">NVIDIA License System
Documentation</a> explains in full detail how to install, configure, and manage license
tokens.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must <a class="reference external" href="https://docs.nvidia.com/license-system/latest/nvidia-license-system-quick-start-guide/index.html#generating-client-configuration-token-for-cls-instance">generate a Client License Token for the CLS Instance</a> prior to proceeding.</p>
</div>
<ol class="arabic">
<li><p>Create a new project called nvidia-gpu-operator</p>
<img alt="gpu-operator/nvaie_ocp/graphics/create_project_1.png" src="gpu-operator/nvaie_ocp/graphics/create_project_1.png" />
<img alt="gpu-operator/nvaie_ocp/graphics/create_project_2.png" src="gpu-operator/nvaie_ocp/graphics/create_project_2.png" />
</li>
<li><p>Select the Workloads Drop Down menu.</p></li>
<li><p>Select <strong>ConfigMaps</strong></p></li>
<li><p>Click Create ConfigMap</p>
<img alt="gpu-operator/nvaie_ocp/graphics/create_config_map1.png" src="gpu-operator/nvaie_ocp/graphics/create_config_map1.png" />
</li>
<li><p>Enter the details for your ConfigMap for the CLS Licensing</p>
<img alt="gpu-operator/nvaie_ocp/graphics/create_config_maps2.png" src="gpu-operator/nvaie_ocp/graphics/create_config_maps2.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must copy/paste the information for your CLS client token into the client_configuration_token.tok parameter.</p>
</div>
</li>
<li><p>Click Create</p></li>
</ol>
</section>
<section id="import-ngc-secret">
<h3>Import NGC Secret<a class="headerlink" href="#import-ngc-secret" title="Permalink to this heading"></a></h3>
<p>OpenShift has a secret object type which provides a mechanism for holding sensitive information such as passwords and private source repository credentials. Next you will create a secret object for storing our NGC API key (the mechanism used to authenticate your access to the
NGC container registry).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Before you begin you will need to generate or use an existing <a class="reference external" href="https://docs.nvidia.com/ngc/ngc-private-registry-user-guide/index.html#generating-api-key">API key</a>.</p>
</div>
<ol class="arabic">
<li><p>Click Secrets from the Workloads drop down</p></li>
<li><p>Click the Create Drop down</p></li>
<li><p>Select Image Pull Secret</p>
<img alt="gpu-operator/nvaie_ocp/graphics/secrets.png" src="gpu-operator/nvaie_ocp/graphics/secrets.png" />
</li>
<li><p>Enter the following into each field</p></li>
</ol>
<blockquote>
<div><p>Secret name: gpu-operator-secret</p>
<p>Authentication type: Image registry credentials</p>
<p>Registry server address: nvcr.io/nvaie</p>
<p>Username: $oauthtoken</p>
<p>Password: &lt;API-KEY&gt;</p>
<p>Email: &lt;YOUR-EMAIL&gt;</p>
<img alt="gpu-operator/nvaie_ocp/graphics/secrets_2.png" src="gpu-operator/nvaie_ocp/graphics/secrets_2.png" />
</div></blockquote>
<ol class="arabic simple">
<li><p>Click Create</p></li>
</ol>
</section>
<section id="install-the-node-feature-discovery-operator">
<h3>Install the Node Feature Discovery Operator<a class="headerlink" href="#install-the-node-feature-discovery-operator" title="Permalink to this heading"></a></h3>
<p>Follow the guidance in <a class="reference internal" href="../openshift/install-nfd.html#install-nfd"><span class="std std-ref">Installing the Node Feature Discovery (NFD) Operator</span></a> to install the Node Feature Discovery Operator.</p>
</section>
<section id="install-the-nvidia-gpu-operator">
<h3>Install the NVIDIA GPU Operator<a class="headerlink" href="#install-the-nvidia-gpu-operator" title="Permalink to this heading"></a></h3>
<p>Follow the guidance in <a class="reference internal" href="../openshift/install-gpu-ocp.html#install-nvidiagpu"><span class="std std-ref">Installing the NVIDIA GPU Operator</span></a> to install the NVIDIA GPU Operator.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Skip the guidance associated with comes creating the cluster policy instead carry out the steps below.</p>
</div>
</section>
<section id="create-the-cluster-policy-instance">
<h3>Create the Cluster Policy Instance<a class="headerlink" href="#create-the-cluster-policy-instance" title="Permalink to this heading"></a></h3>
<section id="next-we-will-create-the-cluster-policy-which-is-responsible-for-maintaining-policy-resources-to-create-pods-in-a-cluster">
<h4>Next, we will create the cluster policy, which is responsible for maintaining policy resources to create pods in a cluster. <a class="reference external" href="https://docs.nvidia.com/datacenter/cloud-native/gpu-operator/openshift/install-gpu-ocp.html#id1">¶</a><a class="headerlink" href="#next-we-will-create-the-cluster-policy-which-is-responsible-for-maintaining-policy-resources-to-create-pods-in-a-cluster" title="Permalink to this heading"></a></h4>
<ol class="arabic">
<li><p>In the OpenShift Container Platform web console, from the side menu, select <strong>Operators</strong> &gt; <strong>Installed Operators</strong>, and click <strong>NVIDIA GPU Operator</strong>.</p></li>
<li><p>Select the <strong>ClusterPolicy</strong> tab, then click <strong>Create ClusterPolicy</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The platform assigns the default name <em>gpu-cluster-policy</em>.</p>
</div>
</li>
<li><p>Expand the drop down for <strong>Driver config</strong> and then <strong>Licensing Config.</strong> In the text box labeled <strong>Config Map Name,</strong> enter the name
of the licensing config map that was previously created (for example <em>licensing-config</em>). Check the <strong>NLS Enabled</strong> checkbox. Refer the
screenshot below for parameter examples and modify values accordingly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This was previously created in Step 2: Create CLS License Config Map.</p>
</div>
</li>
</ol>
<img alt="gpu-operator/nvaie_ocp/graphics/cluster_policy_1.png" src="gpu-operator/nvaie_ocp/graphics/cluster_policy_1.png" />
<ol class="arabic simple">
<li><p>Scroll down to specify repository path, image name and NVIDIA vGPU driver version bundled under <strong>Driver</strong> section. Refer the screenshot below for parameter examples and modify values accordingly.</p></li>
</ol>
<blockquote>
<div><p>nlsEnabled: true</p>
<p>repository: nvcr.io/nvaie</p>
<p>version: 510.47.03</p>
<p>image: vgpu-guest-driver</p>
</div></blockquote>
<ol class="arabic">
<li><p>Expand the <strong>Advanced configuration</strong> menu and specify the imagePullSecret . (eg: <em>gpu-operator-secret</em>)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This was previously created in Step 3: Import NGC Secret.</p>
</div>
<img alt="gpu-operator/nvaie_ocp/graphics/pull-secret.png" src="gpu-operator/nvaie_ocp/graphics/pull-secret.png" />
</li>
<li><p>Click <strong>Create</strong>.</p></li>
</ol>
<p>The GPU Operator will proceed to install all the required components to set up the NVIDIA GPUs in the OpenShift cluster.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Wait at least 10-20 minutes before digging deeper into any form of troubleshooting because this may take some time to finish.</p>
</div>
<p>The status of the newly deployed ClusterPolicy <em>gpu-cluster-policy</em> for the NVIDIA GPU Operator changes to State:ready when the installation succeeds.</p>
<img alt="gpu-operator/nvaie_ocp/graphics/cluster-policy-suceed.png" src="gpu-operator/nvaie_ocp/graphics/cluster-policy-suceed.png" />
<p>Verify the ClusterPolicy installation from the CLI run:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>oc<span class="w"> </span>get<span class="w"> </span>nodes<span class="w"> </span>-o<span class="o">=</span>custom-columns<span class="o">=</span><span class="s1">&#39;Node:metadata.name,GPUs:status.capacity.nvidia\.com/gpu&#39;</span>
</pre></div>
</div>
</div></blockquote>
<p>This lists each node and the number of GPUs it has available to Kubernetes.</p>
<blockquote>
<div><p><strong>Example output</strong></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>oc<span class="w"> </span>get<span class="w"> </span>nodes<span class="w"> </span>-o<span class="o">=</span>custom-columns<span class="o">=</span><span class="s1">&#39;Node:metadata.name,GPUs:status.capacity.nvidia\.com/gpu&#39;</span>

<span class="go">  Node GPUs</span>

<span class="go">  nvaie-ocp-7rfr8-master-0 &lt;none&gt;</span>

<span class="go">  nvaie-ocp-7rfr8-master-1 &lt;none&gt;</span>

<span class="go">  nvaie-ocp-7rfr8-master-2 &lt;none&gt;</span>

<span class="go">  nvaie-ocp-7rfr8-worker-7x5km 1</span>

<span class="go">  nvaie-ocp-7rfr8-worker-9jgmk &lt;none&gt;</span>

<span class="go">  nvaie-ocp-7rfr8-worker-jntsp 1</span>

<span class="go">  nvaie-ocp-7rfr8-worker-zkggt &lt;none&gt;</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2023, NVIDIA Corporation.
      <span class="lastupdated">Last updated on 2023-04-05.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
  a:link, a:visited {
    color: #76b900;
  }

  a:hover {
    color: #8c0;
  }

  .rst-content dl:not(.docutils) dt {
    background: rgba(118, 185, 0, 0.1);
    color: rgba(59,93,0,1);
    border-top: solid 3px rgba(59,93,0,1);
  }
  </style>
  

</body>
</html>