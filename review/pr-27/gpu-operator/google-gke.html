<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NVIDIA GPU Operator with Google GKE &mdash; NVIDIA Cloud Native Technologies  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/nvidia.ico"/>
    <link rel="canonical" href="https://docs.nvidia.com/datacenter/cloud-native/gpu-operator/google-gke.html"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/js/google-analytics/google-analytics-tracker.js"></script>
        <script src="../_static/js/google-analytics/google-analytics-write.js"></script>
        <script src="//assets.adobedtm.com/b92787824f2e0e9b68dc2e993f9bd995339fe417/satelliteLib-7ba51e58dc61bcb0e9311aadd02a0108ab24cc6c.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Archive" href="archive.html" />
    <link rel="prev" title="NVIDIA GPU Operator with Amazon EKS" href="amazon-eks.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" > 
            <a href="../contents.html">
            <img src="../_static/NVLogo_H_B&W.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #76b900;
    }

    .wy-side-nav-search a:link, .wy-nav-top a:link {
      color: #fff;
    }
    .wy-side-nav-search a:visited, .wy-nav-top a:visited {
      color: #fff;
    }
    .wy-side-nav-search a:hover, .wy-nav-top a:hover {
      color: #fff;
    }

    .wy-menu-vertical a:link, .wy-menu-vertical a:visited {
      color: #d9d9d9
    }

    .wy-menu-vertical a:active {
      background-color: #76b900
    }

    .wy-side-nav-search>div.version {
      color: rgba(0, 0, 0, 0.3)
    }

    .wy-nav-content {
      max-width: 1000px;
    }
  </style>
  
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">NVIDIA Container Toolkit:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../container-toolkit/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../container-toolkit/concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../container-toolkit/arch-overview.html">Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../container-toolkit/install-guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../container-toolkit/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../container-toolkit/user-guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../container-toolkit/release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../container-toolkit/archive.html">Archive</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NVIDIA GPU Operator:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="platform-support.html">Platform Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu-driver-upgrades.html">GPU Driver Upgrades</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-gpu-operator-vgpu.html">NVIDIA vGPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-gpu-operator-nvaie.html">NVIDIA AI Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="openshift/contents.html">GPU Operator on OpenShift</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu-operator-mig.html">GPU Operator with MIG</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu-sharing.html">Time-Slicing GPUs in Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu-operator-rdma.html">GPUDirect RDMA and GPUDirect Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu-operator-kubevirt.html">GPU Operator with KubeVirt</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="appendix.html">Advanced Configurations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="install-gpu-operator-proxy.html">Install GPU Operator in Proxy Environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="install-gpu-operator-air-gapped.html">Install GPU Operator in Air-gapped Environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="install-gpu-operator-outdated-kernels.html">Considerations when Installing with Outdated Kernels in Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="custom-driver-params.html">Customizing NVIDIA GPU Driver Parameters during Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="precompiled-drivers.html">Precompiled Driver Containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="cdi.html">Container Device Interface Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="amazon-eks.html">GPU Operator with Amazon EKS</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">GPU Operator with Google GKE</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="archive.html">Archive</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Kubernetes with GPUs:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes/install-k8s.html">Install Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes/mig-k8s.html">MIG Support in Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes/anthos-guide.html">NVIDIA GPUs with Google Cloud’s Anthos</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NVIDIA GPUs and Red Hat Device Edge</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../edge/nvidia-gpu-with-device-edge.html">Accelerating workloads with NVIDIA GPUs with Red Hat Device Edge</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GPU Telemetry:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gpu-telemetry/dcgm-exporter.html">DCGM-Exporter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-telemetry/dcgm-exporter.html#integrating-gpu-telemetry-into-kubernetes">Integrating GPU Telemetry into Kubernetes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Multi-Instance GPU:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mig/mig.html">Multi-Instance GPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mig/mig-k8s.html">MIG Support in Kubernetes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Driver Containers:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../driver-containers/overview.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Playground:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../playground/dind.html">Docker-in-Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../playground/x-arch.html">Running Cross-Architecture Containers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../contents.html">NVIDIA Cloud Native Technologies</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../contents.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="appendix.html">Advanced Configurations</a> &raquo;</li>
      <li>NVIDIA GPU Operator with Google GKE</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nvidia-gpu-operator-with-google-gke">
<h1>NVIDIA GPU Operator with Google GKE<a class="headerlink" href="#nvidia-gpu-operator-with-google-gke" title="Permalink to this heading"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#about-using-the-operator-with-google-gke" id="id1">About Using the Operator with Google GKE</a></p></li>
<li><p><a class="reference internal" href="#prerequisites" id="id2">Prerequisites</a></p></li>
<li><p><a class="reference internal" href="#procedure" id="id3">Procedure</a></p></li>
<li><p><a class="reference internal" href="#next-steps" id="id4">Next Steps</a></p></li>
<li><p><a class="reference internal" href="#related-information" id="id5">Related Information</a></p></li>
</ul>
</div>
<section id="about-using-the-operator-with-google-gke">
<h2>About Using the Operator with Google GKE<a class="headerlink" href="#about-using-the-operator-with-google-gke" title="Permalink to this heading"></a></h2>
<p>You can use the NVIDIA GPU Operator with Google Kubernetes Engine (GKE),
but you must use an operating system that is supported by the Operator.</p>
<p>By default, Google GKE configures nodes with the Container-Optimized OS with Containerd from Google.
This operating system is not supported by the Operator.</p>
<p>To use a supported operating system, such as Ubuntu 22.04 or 20.04, configure your
GKE cluster entirely with Ubuntu containerd nodes images or with a node pool
that uses Ubuntu containerd node images.</p>
<p>By selecting a supported operating system rather than Container-Optimized OS with Containerd,
you can customize which NVIDIA software components are installed by the GPU Operator at deployment time.
For example, the Operator can deploy GPU driver containers and use the Operator
to manage the lifecycle of the NVIDIA software components.</p>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>You installed and initialized the Google Cloud CLI.
Refer to
<a class="reference external" href="https://cloud.google.com/sdk/gcloud">gcloud CLI overview</a>
in the Google Cloud documentation.</p></li>
<li><p>You have a Google Cloud project to use for your GKE cluster.
Refer to
<a class="reference external" href="https://cloud.google.com/resource-manager/docs/creating-managing-projects">Creating and managing projects</a>
in the Google Cloud documentation.</p></li>
<li><p>You have the project ID for your Google Cloud project.
Refer to <a class="reference external" href="https://cloud.google.com/resource-manager/docs/creating-managing-projects#identifying_projects">Identifying projects</a>
in the Google Cloud documentation.</p></li>
<li><p>You know the machine type for the node pool and that the machine type is supported
in your region and zone.
Refer to <a class="reference external" href="https://cloud.google.com/compute/docs/gpus">GPU platforms</a>
in the Google Cloud documentation.</p></li>
</ul>
</section>
<section id="procedure">
<h2>Procedure<a class="headerlink" href="#procedure" title="Permalink to this heading"></a></h2>
<p>Perform the following steps to create a GKE cluster with the <code class="docutils literal notranslate"><span class="pre">gcloud</span></code> CLI.
The steps create the cluster with a node pool that uses a Ubuntu and containerd node image.</p>
<ol class="arabic">
<li><p>Create the cluster by running a command that is similar to the following example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">  $ </span>gcloud<span class="w"> </span>beta<span class="w"> </span>container<span class="w"> </span>clusters<span class="w"> </span>create<span class="w"> </span>demo-cluster<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--project<span class="w"> </span>&lt;project-id&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--zone<span class="w"> </span>us-west1-a<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--release-channel<span class="w"> </span><span class="s2">&quot;regular&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--machine-type<span class="w"> </span><span class="s2">&quot;n1-standard-4&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--accelerator<span class="w"> </span><span class="s2">&quot;type=nvidia-tesla-t4,count=1&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--image-type<span class="w"> </span><span class="s2">&quot;UBUNTU_CONTAINERD&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--disk-type<span class="w"> </span><span class="s2">&quot;pd-standard&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--disk-size<span class="w"> </span><span class="s2">&quot;1000&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--no-enable-intra-node-visibility<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--metadata<span class="w"> </span>disable-legacy-endpoints<span class="o">=</span><span class="nb">true</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--max-pods-per-node<span class="w"> </span><span class="s2">&quot;110&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--num-nodes<span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--logging<span class="o">=</span>SYSTEM,WORKLOAD<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--monitoring<span class="o">=</span>SYSTEM<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--enable-ip-alias<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--no-enable-intra-node-visibility<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--default-max-pods-per-node<span class="w"> </span><span class="s2">&quot;110&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--no-enable-master-authorized-networks<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--tags<span class="o">=</span>nvidia-ingress-all

<span class="go">Creating the cluster requires several minutes.</span>
</pre></div>
</div>
</li>
<li><p>Get the authentication credentials for the cluster:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">USE_GKE_GCLOUD_AUTH_PLUGIN</span><span class="o">=</span>True<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>gcloud<span class="w"> </span>container<span class="w"> </span>clusters<span class="w"> </span>get-credentials<span class="w"> </span>demo-cluster<span class="w"> </span>--zone<span class="w"> </span>us-west1-a
</pre></div>
</div>
</li>
<li><p>Optional: Verify that you can connect to the cluster:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl<span class="w"> </span>get<span class="w"> </span>nodes<span class="w"> </span>-o<span class="w"> </span>wide
</pre></div>
</div>
</li>
<li><p>Create the namespace for the NVIDIA GPU Operator:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl<span class="w"> </span>create<span class="w"> </span>ns<span class="w"> </span>gpu-operator
</pre></div>
</div>
</li>
<li><p>Create a file, such as <code class="docutils literal notranslate"><span class="pre">gpu-operator-quota.yaml</span></code>, with contents like the following example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ResourceQuota</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpu-operator-quota</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hard</span><span class="p">:</span>
<span class="w">    </span><span class="nt">pods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">scopeSelector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchExpressions</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">In</span>
<span class="w">      </span><span class="nt">scopeName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PriorityClass</span>
<span class="w">      </span><span class="nt">values</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">system-node-critical</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">system-cluster-critical</span>
</pre></div>
</div>
</li>
<li><p>Apply the resource quota:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-n<span class="w"> </span>gpu-operator<span class="w"> </span>-f<span class="w"> </span>gpu-operator-quota.yaml
</pre></div>
</div>
</li>
<li><p>Optional: View the resource quota:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kubectl<span class="w"> </span>get<span class="w"> </span>-n<span class="w"> </span>gpu-operator<span class="w"> </span>resourcequota
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">NAME                  AGE     REQUEST</span>
<span class="go">gke-resource-quotas   6m56s   count/ingresses.extensions: 0/100, count/ingresses.networking.k8s.io: 0/100, count/jobs.batch: 0/5k, pods: 2/1500, services: 1/500</span>
<span class="go">gpu-operator-quota    38s     pods: 0/100</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>You are ready to <a class="reference internal" href="../kubernetes/anthos-guide.html#install-gpu-operator"><span class="std std-ref">install the NVIDIA GPU Operator</span></a>
with Helm.</p></li>
</ul>
</section>
<section id="related-information">
<h2>Related Information<a class="headerlink" href="#related-information" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>If you have an existing GKE cluster, refer to
<a class="reference external" href="https://cloud.google.com/kubernetes-engine/docs/how-to/node-pools">Add and manage node pools</a>
in the Google Kubernetes Engine documentation.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="amazon-eks.html" class="btn btn-neutral float-left" title="NVIDIA GPU Operator with Amazon EKS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="archive.html" class="btn btn-neutral float-right" title="Archive" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2023, NVIDIA Corporation.
      <span class="lastupdated">Last updated on 2023-04-22.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
  a:link, a:visited {
    color: #76b900;
  }

  a:hover {
    color: #8c0;
  }

  .rst-content dl:not(.docutils) dt {
    background: rgba(118, 185, 0, 0.1);
    color: rgba(59,93,0,1);
    border-top: solid 3px rgba(59,93,0,1);
  }
  </style>
  

</body>
</html>