<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NVIDIA AI Enterprise with OpenShift &mdash; NVIDIA Cloud Native Technologies  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../_static/nvidia.ico"/>
    <link rel="canonical" href="https://docs.nvidia.com/datacenter/cloud-native/gpu-operator/archive/22.9.1/openshift/nvaie-with-ocp.html"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../_static/clipboard.min.js"></script>
        <script src="../../../../_static/copybutton.js"></script>
        <script src="../../../../_static/js/google-analytics/google-analytics-tracker.js"></script>
        <script src="../../../../_static/js/google-analytics/google-analytics-write.js"></script>
        <script src="//assets.adobedtm.com/b92787824f2e0e9b68dc2e993f9bd995339fe417/satelliteLib-7ba51e58dc61bcb0e9311aadd02a0108ab24cc6c.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="MIG Support in OpenShift Container Platform" href="mig-ocp.html" />
    <link rel="prev" title="Installing the NVIDIA GPU Operator" href="install-gpu-ocp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" > 
            <a href="../../../../contents.html">
            <img src="../../../../_static/NVLogo_H_B&W.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #76b900;
    }

    .wy-side-nav-search a:link, .wy-nav-top a:link {
      color: #fff;
    }
    .wy-side-nav-search a:visited, .wy-nav-top a:visited {
      color: #fff;
    }
    .wy-side-nav-search a:hover, .wy-nav-top a:hover {
      color: #fff;
    }

    .wy-menu-vertical a:link, .wy-menu-vertical a:visited {
      color: #d9d9d9
    }

    .wy-menu-vertical a:active {
      background-color: #76b900
    }

    .wy-side-nav-search>div.version {
      color: rgba(0, 0, 0, 0.3)
    }

    .wy-nav-content {
      max-width: 1000px;
    }
  </style>
  
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">NVIDIA Container Toolkit:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../container-toolkit/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../container-toolkit/concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../container-toolkit/arch-overview.html">Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../container-toolkit/install-guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../container-toolkit/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../container-toolkit/user-guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../container-toolkit/release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../container-toolkit/archive.html">Archive</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NVIDIA GPU Operator:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../platform-support.html">Platform Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gpu-driver-upgrades.html">GPU Driver Upgrades</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install-gpu-operator-vgpu.html">NVIDIA vGPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install-gpu-operator-nvaie.html">NVIDIA AI Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../openshift/contents.html">GPU Operator on OpenShift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gpu-operator-mig.html">GPU Operator with MIG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gpu-sharing.html">Time-Slicing GPUs in Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gpu-operator-rdma.html">GPUDirect RDMA and GPUDirect Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gpu-operator-kubevirt.html">GPU Operator with KubeVirt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendix.html">Advanced Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../self-validated/index.html">Self-Validated Configurations</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../archive.html">Archive</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../archive.html#id1">22.9.2</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../archive.html#id2">22.9.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../archive.html#id3">22.9.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../archive.html#id4">1.11.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../archive.html#id5">1.11.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../archive.html#id6">1.10.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../archive.html#id7">1.9.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../archive.html#id8">1.9.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../archive.html#id9">1.8</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Kubernetes with GPUs:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../kubernetes/install-k8s.html">Install Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../kubernetes/mig-k8s.html">MIG Support in Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../kubernetes/anthos-guide.html">NVIDIA GPUs with Google Cloud’s Anthos</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NVIDIA GPUs and Red Hat Device Edge</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../edge/nvidia-gpu-with-device-edge.html">Accelerating workloads with NVIDIA GPUs with Red Hat Device Edge</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GPU Telemetry:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../gpu-telemetry/dcgm-exporter.html">DCGM-Exporter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../gpu-telemetry/dcgm-exporter.html#integrating-gpu-telemetry-into-kubernetes">Integrating GPU Telemetry into Kubernetes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Multi-Instance GPU:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../mig/mig.html">Multi-Instance GPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mig/mig-k8s.html">MIG Support in Kubernetes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Driver Containers:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../driver-containers/overview.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Playground:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../playground/dind.html">Docker-in-Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../playground/x-arch.html">Running Cross-Architecture Containers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../contents.html">NVIDIA Cloud Native Technologies</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../contents.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../archive.html">Archive</a> &raquo;</li>
          <li><a href="contents.html">GPU Operator on OpenShift</a> &raquo;</li>
      <li>NVIDIA AI Enterprise with OpenShift</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nvidia-ai-enterprise-with-openshift">
<span id="nvaie-ocp-22-9-1-22-9-1"></span><h1>NVIDIA AI Enterprise with OpenShift<a class="headerlink" href="#nvidia-ai-enterprise-with-openshift" title="Permalink to this heading"></a></h1>
<p>NVIDIA AI Enterprise is an end-to-end, cloud-native suite of AI and data analytics software, optimized, certified, and supported by NVIDIA with NVIDIA-Certified Systems. Additional information can be found at the <a class="reference external" href="https://www.nvidia.com/en-us/data-center/products/ai-enterprise-suite/#benefits">NVIDIA AI Enterprise web page</a>.</p>
<p>The following methods of installation are supported:</p>
<ul class="simple">
<li><p>OpenShift Container Platform on bare metal or VMware vSphere with GPU Passthrough</p></li>
<li><p>OpenShift Container Platform on VMware vSphere with NVIDIA vGPU</p></li>
</ul>
<section id="openshift-container-platform-bare-metal-or-vmware-vsphere-with-gpu-passthrough">
<h2>OpenShift Container Platform bare metal or VMware vSphere with GPU Passthrough<a class="headerlink" href="#openshift-container-platform-bare-metal-or-vmware-vsphere-with-gpu-passthrough" title="Permalink to this heading"></a></h2>
<p>For OpenShift Container Platform bare metal or VMware vSphere with GPU Passthrough you do not need to make changes to the <cite>ClusterPolicy</cite>. Follow the guidance in <a class="reference internal" href="install-gpu-ocp.html#install-nvidiagpu-22-9-1"><span class="std std-ref">Installing the NVIDIA GPU Operator</span></a> to install the NVIDIA GPU Operator.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The option exists to use the vGPU driver with bare metal and VMware vSphere VMs with GPU Passthrough. In this case, follow the guidance in the section “OpenShift Container Platform on VMware vSphere with NVIDIA vGPU”.</p>
</div>
</section>
<section id="openshift-container-platform-on-vmware-vsphere-with-nvidia-vgpus">
<h2>OpenShift Container Platform on VMware vSphere with NVIDIA vGPUs<a class="headerlink" href="#openshift-container-platform-on-vmware-vsphere-with-nvidia-vgpus" title="Permalink to this heading"></a></h2>
<section id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h3>
<p>This section provides insights into deploying NVIDIA AI Enterprise for VMware vSphere with RedHat OpenShift Container Platform.</p>
<p>The steps involved are:</p>
<ul class="simple">
<li><p>Step 1: Install Node Feature Discovery (NFD) Operator</p></li>
<li><p>Step 2: Install NVIDIA GPU Operator</p></li>
<li><p>Step 3: Create the NGC secret</p></li>
<li><p>Step 4: Create the ConfigMap</p></li>
<li><p>Step 5: Create the Cluster Policy</p></li>
</ul>
</section>
<section id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h3>
<p>When NVIDIA AI Enterprise is running on VMware vSphere based virtualized infrastructure, a key component is NVIDIA virtual GPU. The NVIDIA AI Enterprise Host Software vSphere Installation Bundle (VIB) is installed on the VMware ESXi host server and it is responsible for communicating with the NVIDIA vGPU guest driver which is
installed on the guest VM. Guest VMs use the NVIDIA vGPUs in the same manner as a physical GPU that has been passed through by the hypervisor. In the VM itself, vGPU drivers are installed which support the different license levels that are available.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Installing the NVIDIA vGPU Host Driver VIB on the ESXi host is out of the scope of this document. See the <strong>NVIDIA AI Enterprise Deployment Guide</strong> for detailed instructions.</p>
</div>
</section>
<section id="red-hat-openshift-on-vmware-vsphere">
<h3>Red Hat OpenShift on VMware vSphere<a class="headerlink" href="#red-hat-openshift-on-vmware-vsphere" title="Permalink to this heading"></a></h3>
<p>Follow the steps outlined in the <a class="reference external" href="https://docs.openshift.com/container-platform/latest/installing/installing_vsphere/preparing-to-install-on-vsphere.html">Installing vSphere section</a> of the RedHat OpenShift documentation installing OpenShift on vSphere.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using virtualized GPUs you must change the boot method of each VM that is deployed as a worker and the VM template to be EFI.
This requires powering down running worker VMs. The template must be converted to a VM, then change the boot method to EFI, then convert back
to a template.</p>
<p>Secure boot also needs to be disabled as shown:</p>
<blockquote>
<div><img alt="../../../../_images/vmx_secure_boot4.png" src="../../../../_images/vmx_secure_boot4.png" />
</div></blockquote>
<p>When using the <a class="reference external" href="https://docs.openshift.com/container-platform/latest/installing/installing_vsphere/installing-vsphere.html#installation-vsphere-machines_installing-vsphere">UPI install method</a>, after <strong>Step 8</strong> of the “Installing RHCOS and starting the OpenShift
Container Platform bootstrap process” change the boot method to EFI before <strong>continuing to Step 9</strong>.</p>
<p>When using the IPI method, each VM’s boot method can be changed to EFI after VM deployment.</p>
<p>In addition to the EFI boot setting, ensure that the VM has the following configuration parameters set:</p>
<p><strong>VM Settings</strong> &gt; <strong>VM options</strong> &gt; <strong>Advanced</strong> &gt; <strong>Configuration Parameters</strong> &gt; <strong>Edit Configuration</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">pciPassthru.use64bitMMIO</span> <span class="pre">TRUE</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">pciPassthru.64bitMMIOSizeGB</span> <span class="pre">512</span></code></p>
<blockquote>
<div><img alt="../../../../_images/pci_passthrough4.png" src="../../../../_images/pci_passthrough4.png" />
</div></blockquote>
<p>To support GPUDirect RDMA ensure that the VM has the following configuration parameters set:</p>
<p><strong>VM Settings</strong> &gt; <strong>VM options</strong> &gt; <strong>Advanced</strong> &gt; <strong>Configuration Parameters</strong> &gt; <strong>Edit Configuration</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">pciPassthru.allowP2P</span> <span class="pre">=</span> <span class="pre">true</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">pciPassthru.RelaxACSforP2P</span> <span class="pre">=</span> <span class="pre">true</span></code></p>
</div>
</div></blockquote>
<p>It is also recommended that you reference <a class="reference external" href="https://core.vmware.com/resource/running-red-hat-openshift-container-platform-vmware-cloud-foundation#executive-summary">Running Red Hat OpenShift Container Platform on VMware Cloud Foundation</a> documentation for deployment best practices, system configuration, and reference architecture.</p>
</section>
<section id="install-node-feature-discovery-operator">
<h3>Install Node Feature Discovery Operator<a class="headerlink" href="#install-node-feature-discovery-operator" title="Permalink to this heading"></a></h3>
<p>Follow the guidance in <a class="reference internal" href="install-nfd.html#install-nfd-22-9-1"><span class="std std-ref">Installing the Node Feature Discovery (NFD) Operator</span></a> to install the Node Feature Discovery Operator.</p>
</section>
<section id="install-nvidia-gpu-operator">
<h3>Install NVIDIA GPU Operator<a class="headerlink" href="#install-nvidia-gpu-operator" title="Permalink to this heading"></a></h3>
<p>Follow the guidance in <a class="reference internal" href="install-gpu-ocp.html#install-nvidiagpu-22-9-1"><span class="std std-ref">Installing the NVIDIA GPU Operator</span></a> to install the NVIDIA GPU Operator.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Skip the guidance associated with creating the cluster policy instead follow the guidance in the subsequent sections.</p>
</div>
</section>
<section id="create-the-ngc-secret">
<h3>Create the NGC secret<a class="headerlink" href="#create-the-ngc-secret" title="Permalink to this heading"></a></h3>
<p>OpenShift has a secret object type which provides a mechanism for holding sensitive information such as passwords and private source repository credentials. Next you will create a secret object for storing our NGC API key (the mechanism used to authenticate your access to the
NGC container registry).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Before you begin you will need to generate or use an existing <a class="reference external" href="https://docs.nvidia.com/ngc/ngc-private-registry-user-guide/index.html#generating-api-key">API key</a>.</p>
</div>
<ol class="arabic">
<li><p>Navigate to <strong>Home</strong> &gt; <strong>Projects</strong> and ensure the <code class="docutils literal notranslate"><span class="pre">nvidia-gpu-operator</span></code> is selected.</p></li>
<li><p>In the OpenShift Container Platform web console, click <strong>Secrets</strong> from the Workloads drop down.</p></li>
<li><p>Click the <strong>Create</strong> Drop down.</p></li>
<li><p>Select Image Pull Secret.</p>
<img alt="../../../../_images/secrets4.png" src="../../../../_images/secrets4.png" />
</li>
<li><p>Enter the following into each field:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Secret name</strong>: ngc-secret</p></li>
<li><p><strong>Authentication type</strong>: Image registry credentials</p></li>
<li><p><strong>Registry server address</strong>: nvcr.io/nvaie</p></li>
<li><p><strong>Username</strong>: $oauthtoken</p></li>
<li><p><strong>Password</strong>: &lt;API-KEY&gt;</p></li>
<li><p><strong>Email</strong>: &lt;YOUR-EMAIL&gt;</p></li>
</ul>
</div></blockquote>
<img alt="../../../../_images/secrets_24.png" src="../../../../_images/secrets_24.png" />
</li>
<li><p>Click <strong>Create</strong>.</p>
<p>A pull secret is created.</p>
<img alt="../../../../_images/created_pull-secret4.png" src="../../../../_images/created_pull-secret4.png" />
</li>
</ol>
</section>
<section id="create-the-configmap-for-nls-token">
<h3>Create the ConfigMap for NLS Token<a class="headerlink" href="#create-the-configmap-for-nls-token" title="Permalink to this heading"></a></h3>
<section id="prerequisites">
<h4>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading"></a></h4>
<p>Generate and download a NLS client license token. See Section 4.6 of the <a class="reference external" href="https://docs.nvidia.com/license-system/latest/pdf/nvidia-license-system-user-guide.pdf">NVIDIA License System User Guide</a> for instructions.</p>
</section>
<section id="procedure">
<h4>Procedure<a class="headerlink" href="#procedure" title="Permalink to this heading"></a></h4>
<ol class="arabic">
<li><p>Navigate to <strong>Home</strong> &gt; <strong>Projects</strong> and ensure the <code class="docutils literal notranslate"><span class="pre">nvidia-gpu-operator</span></code> is selected.</p></li>
<li><p>Select the <strong>Workloads</strong> Drop Down menu.</p></li>
<li><p>Select <strong>ConfigMaps</strong>.</p></li>
<li><p>Click <strong>Create ConfigMap</strong>.</p>
<img alt="../../../../_images/create_config_map14.png" src="../../../../_images/create_config_map14.png" />
</li>
<li><p>Enter the details for your ConfigMap.</p>
<ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">name</span></code> must be <code class="docutils literal notranslate"><span class="pre">licensing-config</span></code>.</p></li>
<li><p>Copy and paste the information for your NLS client token into the <code class="docutils literal notranslate"><span class="pre">client_configuration_token.tok</span></code> parameter.</p></li>
</ol>
</li>
<li><p>Click <strong>Create</strong>.</p>
<p><strong>Example output</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">licensing-config</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w"> </span><span class="nt">client_configuration_token.tok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">  </span><span class="no">tJ8EKOD5-rN7sSUWyHKsrvVSgfRYucvKo-lg&lt;SNIP&gt;</span>
<span class="w"> </span><span class="nt">gridd.conf</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;#</span><span class="nv"> </span><span class="s">empty</span><span class="nv"> </span><span class="s">file&#39;</span>
</pre></div>
</div>
</li>
<li><p>The created ConfigMap should resemble the following:</p>
<img alt="../../../../_images/create_config_maps24.png" src="../../../../_images/create_config_maps24.png" />
</li>
</ol>
</section>
</section>
<section id="create-the-cluster-policy-instance">
<h3>Create the Cluster Policy Instance<a class="headerlink" href="#create-the-cluster-policy-instance" title="Permalink to this heading"></a></h3>
<p>Now create the cluster policy, which is responsible for maintaining policy resources to create pods in a cluster.</p>
<ol class="arabic">
<li><p>In the OpenShift Container Platform web console, from the side menu, select <strong>Operators</strong> &gt; <strong>Installed Operators</strong>, and click <strong>NVIDIA GPU Operator</strong>.</p></li>
<li><p>Select the <strong>ClusterPolicy</strong> tab, then click <strong>Create ClusterPolicy</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The platform assigns the default name <em>gpu-cluster-policy</em>.</p>
</div>
</li>
<li><p>Expand the drop down for <strong>NVIDIA GPU/vGPU Driver config</strong> and then <strong>licensingConfig.</strong> In the text box labeled <strong>configMapName,</strong> enter the name of the licensing config map that was previously created (for example <em>licensing-config</em>). Check the <strong>nlsEnabled</strong> checkbox.
Refer the screenshots for parameter examples and modify values accordingly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This was previously created in the previous section “Create the ConfigMap for NLS Token”.</p>
</div>
<img alt="../../../../_images/cluster_policy_14.png" src="../../../../_images/cluster_policy_14.png" />
<ul class="simple">
<li><p><strong>configMapName</strong>: licensing-config</p></li>
<li><p><strong>nlsEnabled</strong>: Enabled</p></li>
</ul>
</li>
<li><p>Scroll down to specify repository path under the <strong>NVIDIA GPU/vGPU Driver config</strong> section. See the screenshot below for parameter examples and modify values accordingly.</p>
<img alt="../../../../_images/createclusterpolicy24.png" src="../../../../_images/createclusterpolicy24.png" />
<ul class="simple">
<li><p><strong>enabled</strong>: Enabled</p></li>
<li><p><strong>repository</strong>: <code class="docutils literal notranslate"><span class="pre">nvcr.io/nvaie</span></code></p></li>
</ul>
<ol class="arabic">
<li><p>Expand the rdma menu and check <strong>enabled</strong> if you want to deploy GPUDirect RDMA:</p>
<img alt="../../../../_images/enable-gpu-direct-rdma4.png" src="../../../../_images/enable-gpu-direct-rdma4.png" />
</li>
</ol>
</li>
<li><p>Scroll down further to image name and specifgy the NVIDIA vGPU driver version under the <strong>NVIDIA GPU/vGPU Driver config</strong> section.</p>
<img alt="../../../../_images/createclusterpolicy34.png" src="../../../../_images/createclusterpolicy34.png" />
<ul>
<li><p><strong>version</strong>: 525.60.13</p></li>
<li><p><strong>image</strong>: vgpu-guest-driver-3-0</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The above version and image are examples for NVIDIA AI Enterprise 3.0. Please update the vGPU driver version and image for the appropriate OpenShift Container Platform version.</p>
<ul class="simple">
<li><p>4.9 is <code class="docutils literal notranslate"><span class="pre">nvcr.io/nvaie/vgpu-guest-driver-3-0:525.60.13-rhcos4.9</span></code></p></li>
<li><p>4.10 is <code class="docutils literal notranslate"><span class="pre">nvcr.io/nvaie/vgpu-guest-driver-3-0:525.60.13-rhcos4.10</span></code></p></li>
<li><p>4.11 is <code class="docutils literal notranslate"><span class="pre">nvcr.io/nvaie/vgpu-guest-driver-3-0:525.60.13-rhcos4.11</span></code></p></li>
</ul>
</div>
</div></blockquote>
</li>
</ul>
</li>
<li><p>Expand the <strong>Advanced configuration</strong> menu and specify the imagePullSecret.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This was previously created in the section “Create NGC secret”.</p>
</div>
<img alt="../../../../_images/cluster_policy_44.png" src="../../../../_images/cluster_policy_44.png" />
</li>
<li><p>Click <strong>Create</strong>.</p></li>
</ol>
<p>The GPU Operator proceeds to install all the required components to set up the NVIDIA GPUs in the OpenShift Container Platform cluster.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Wait at least 10-20 minutes before digging deeper into any form of troubleshooting because this may take some time to finish.</p>
</div>
<p>The status of the newly deployed ClusterPolicy <em>gpu-cluster-policy</em> for the NVIDIA GPU Operator changes to <code class="docutils literal notranslate"><span class="pre">State:ready</span></code> when the installation succeeds.</p>
<img alt="../../../../_images/cluster_policy_suceed7.png" src="../../../../_images/cluster_policy_suceed7.png" />
<p>Verify the ClusterPolicy installation from the CLI run:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>oc<span class="w"> </span>get<span class="w"> </span>nodes<span class="w"> </span>-o<span class="o">=</span>custom-columns<span class="o">=</span><span class="s1">&#39;Node:metadata.name,GPUs:status.capacity.nvidia\.com/gpu&#39;</span>
</pre></div>
</div>
</div></blockquote>
<p>This lists each node and the number of GPUs.</p>
<blockquote>
<div><p><strong>Example output</strong></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>oc<span class="w"> </span>get<span class="w"> </span>nodes<span class="w"> </span>-o<span class="o">=</span>custom-columns<span class="o">=</span><span class="s1">&#39;Node:metadata.name,GPUs:status.capacity.nvidia\.com/gpu&#39;</span>

<span class="go">  Node GPUs</span>

<span class="go">  nvaie-ocp-7rfr8-master-0 &lt;none&gt;</span>

<span class="go">  nvaie-ocp-7rfr8-master-1 &lt;none&gt;</span>

<span class="go">  nvaie-ocp-7rfr8-master-2 &lt;none&gt;</span>

<span class="go">  nvaie-ocp-7rfr8-worker-7x5km 1</span>

<span class="go">  nvaie-ocp-7rfr8-worker-9jgmk &lt;none&gt;</span>

<span class="go">  nvaie-ocp-7rfr8-worker-jntsp 1</span>

<span class="go">  nvaie-ocp-7rfr8-worker-zkggt &lt;none&gt;</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="verify-the-successful-installation-of-the-nvidia-gpu-operator">
<h3>Verify the successful installation of the NVIDIA GPU Operator<a class="headerlink" href="#verify-the-successful-installation-of-the-nvidia-gpu-operator" title="Permalink to this heading"></a></h3>
<p>Perform the following steps to verify the successful installation of the <strong>NVIDIA GPU Operator</strong>.</p>
<ol class="arabic">
<li><p>In the OpenShift Container Platform web console, from the side menu, select <strong>Workloads</strong> &gt; <strong>Pods</strong>.</p></li>
<li><p>Under the <strong>Project</strong> drop down select the <strong>nvidia-gpu-operator</strong> project.</p></li>
<li><p>Verify the pods are successfully deployed.</p></li>
<li><p>Alternatively from the command line run the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>oc<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>nvidia-gpu-operator
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">NAME                                                                  READY   STATUS      RESTARTS   AGE</span>
<span class="go">pod/gpu-feature-discovery-hlpgs                                       1/1     Running     0          91m</span>
<span class="go">pod/gpu-operator-8dc8d6648-jzhnr                                      1/1     Running     0          94m</span>
<span class="go">pod/nvidia-dcgm-exporter-ds9xd                                        1/1     Running     0          91m</span>
<span class="go">pod/nvidia-dcgm-k7tz6                                                 1/1     Running     0          91m</span>
<span class="go">pod/nvidia-device-plugin-daemonset-nqxmc                              1/1     Running     0          91m</span>
<span class="go">pod/nvidia-driver-daemonset-49.84.202202081504-0-9df9j                2/2     Running     0          91m</span>
<span class="go">pod/nvidia-node-status-exporter-7bhdk                                 1/1     Running     0          91m</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="install-gpu-ocp.html" class="btn btn-neutral float-left" title="Installing the NVIDIA GPU Operator" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mig-ocp.html" class="btn btn-neutral float-right" title="MIG Support in OpenShift Container Platform" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2023, NVIDIA Corporation.
      <span class="lastupdated">Last updated on 2023-04-17.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
  a:link, a:visited {
    color: #76b900;
  }

  a:hover {
    color: #8c0;
  }

  .rst-content dl:not(.docutils) dt {
    background: rgba(118, 185, 0, 0.1);
    color: rgba(59,93,0,1);
    border-top: solid 3px rgba(59,93,0,1);
  }
  </style>
  

</body>
</html>